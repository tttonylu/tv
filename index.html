<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>ç¯è¾°æ–‡åŒ– Â· å±å¹•æ—¥å¿—è¯Šæ–­ç‰ˆ</title>
    <style>
        /* è§†è§‰é£æ ¼ */
        :root {
            --bg-image: url('https://s21.ax1x.com/2025/11/25/pZAQ501.png');
            --glass-bg: rgba(0, 0, 0, 0.85); --glass-border: rgba(212, 175, 55, 0.6);
            --font-title: "KaiTi", "STKaiti", serif; --font-body: "Songti SC", "SimSun", serif; 
            --color-gold: #ffd700; --color-red: #ff4d4d; --color-green: #4caf50; --color-yellow: #ffaa00; --text-main: #ffffff;
        }
        body { margin: 0; background: var(--bg-image); background-size: cover; background-position: center; color: var(--text-main); font-family: var(--font-body); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        
        /* ğŸ”´ å±å¹•æ—¥å¿—æ¡† (ä¸“æ²»å„ç§ä¸æ˜¾ç¤º) */
        #console-log {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 9999;
            color: #0f0; font-family: monospace; font-size: 16px;
            padding: 20px; box-sizing: border-box; overflow-y: auto;
            white-space: pre-wrap;
        }
        .log-err { color: #ff4d4d; font-weight: bold; border: 1px solid red; padding: 10px; margin: 10px 0; }
        .log-ok { color: #4caf50; }
        .log-info { color: #888; }

        /* ç•Œé¢å…ƒç´  */
        header { height: 12vh; display: flex; justify-content: center; align-items: center; border-bottom: 3px double var(--color-gold); background: rgba(0,0,0,0.6); position: relative; }
        .brand { font-family: var(--font-title); font-size: 5vh; color: var(--color-gold); letter-spacing: 5px; font-weight: bold; text-shadow: 0 2px 5px #000; }
        .date-info { position: absolute; right: 30px; text-align: right; color: #ddd; }
        #clock { font-family: 'Times New Roman'; font-size: 4vh; font-weight: bold; color: var(--color-gold); }
        #date-text { font-size: 2vh; opacity: 0.8; margin-top: 5px; }
        main { flex: 1; display: flex; padding: 2vh; gap: 2vh; }
        .glass-panel { background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.8); }
        .sidebar { flex: 25; display: flex; flex-direction: column; gap: 2vh; }
        .stat-card { padding: 2vh; text-align: center; border-bottom: 1px dashed rgba(255,255,255,0.2); }
        .stat-label { font-size: 2.5vh; color: #ccc; margin-bottom: 1vh; font-family: var(--font-title);}
        .stat-num { font-family: 'Times New Roman'; font-size: 7vh; color: var(--color-gold); font-weight: bold; line-height: 1;}
        .marquee-box { flex: 1; padding: 2vh; overflow: hidden; position: relative; }
        .marquee-content { position: absolute; width: 100%; }
        .scroll-active { animation: scrollUp 40s linear infinite; }
        .future-item { padding: 1.5vh 0; border-bottom: 1px dashed #555; font-size: 2.2vh; display: flex; justify-content: space-between; }
        @keyframes scrollUp { 0% { top: 100%; } 100% { top: -300%; } }
        .master-grid { flex: 75; display: grid; grid-template-columns: repeat(auto-fit, minmax(22%, 1fr)); gap: 2vh; }
        .master-card { display: flex; flex-direction: column; align-items: center; padding: 2vh; transition: transform 0.3s; }
        .avatar-frame { width: 16vh; height: 16vh; border-radius: 50%; border: 3px solid var(--color-gold); padding: 3px; background: #000; margin-bottom: 2vh; box-shadow: 0 5px 20px #000; overflow: hidden; display: flex; justify-content: center; align-items: center; position: relative; }
        .avatar-img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .master-name { font-family: var(--font-title); font-size: 3.5vh; color: var(--color-gold); margin-bottom: 2vh; letter-spacing: 3px; }
        .status-badge { margin-top: auto; padding: 1vh 0; width: 100%; text-align: center; font-size: 2.5vh; border-radius: 4px; font-family: var(--font-title); font-weight: bold; }
        .client-info-box { width: 100%; min-height: 8vh; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-bottom: 1vh; background: rgba(255,255,255,0.05); border-radius: 4px; }
        .c-name { font-size: 3vh; color: #fff; font-weight: bold; margin-bottom: 0.5vh; }
        .c-time { color: #aaa; font-family: 'Times New Roman'; font-size: 2.2vh; }
        .busy { border-color: var(--color-red); } .busy .avatar-frame { border-color: var(--color-red); } .busy .status-badge { background: var(--color-red); color: #fff; }
        .preparing { border-color: var(--color-yellow); } .preparing .avatar-frame { border-color: var(--color-yellow); } .preparing .status-badge { background: var(--color-yellow); color: #000; }
        .free { border-color: var(--color-green); } .free .avatar-frame { filter: grayscale(100%); opacity: 0.8; } .free .status-badge { border: 1px solid var(--color-green); color: var(--color-green); }
    </style>
</head>
<body>

<div id="console-log">
    <div style="color:#fff; font-size:20px; margin-bottom:20px;">ğŸ› ï¸ ç³»ç»Ÿè‡ªæ£€å¯åŠ¨...</div>
</div>

<header>
    <div class="brand">ç¯è¾°æ–‡åŒ–å‘½ç†æœåŠ¡ä¸­å¿ƒ</div>
    <div class="date-info"><div id="clock">00:00:00</div><div id="date-text">...</div></div>
</header>
<main>
    <aside class="sidebar glass-panel">
        <div class="stat-card"><div class="stat-label">ä»Šæ—¥æ€»ç¼˜ä¸»</div><div class="stat-num" id="count-total">0</div></div>
        <div class="stat-card"><div class="stat-label">ç­‰å¾…æ¥å¼•</div><div class="stat-num" id="count-wait" style="color:#fff">0</div></div>
        <div class="marquee-box"><div style="text-align:center; color:var(--color-gold); border-bottom:2px solid var(--color-red); padding-bottom:10px; margin-bottom:10px; font-family:var(--font-title); font-size: 2.5vh;">ğŸ“… é¢„çº¦å®å†µ</div><div class="marquee-content" id="future-list"></div></div>
    </aside>
    <div class="master-grid" id="master-grid"></div>
</main>

<script>
    // ==========================================
    // ğŸ”´ å¿…é¡»ä¿®æ”¹ï¼šè¯·å¡«å…¥æ‚¨è‡ªå·±çš„ Token å’Œ ID
    // ==========================================
    const VIKA_CONFIG = {
        TOKEN: "uskRMINs8MRQZD07iTNuNnl",  // ğŸ‘ˆ è¯·ç¡®ä¿è¿™é‡Œæ˜¯æ‚¨è‡ªå·±çš„ Token
        DATASHEET_ID: "dstmgbUypiy0LbUzwF" // ğŸ‘ˆ è¯·ç¡®ä¿è¿™é‡Œæ˜¯æ‚¨è‡ªå·±çš„ ID
    };

    // ==========================================
    // ğŸ› ï¸ æ—¥å¿—å·¥å…·
    // ==========================================
    function log(msg, type='info') {
        const box = document.getElementById('console-log');
        const time = new Date().toLocaleTimeString();
        let style = 'color:#fff';
        if(type==='err') style = 'color:#ff4d4d; font-weight:bold;';
        if(type==='ok') style = 'color:#4caf50;';
        box.innerHTML += `<div style="${style}">[${time}] ${msg}</div>`;
    }

    // ==========================================
    // ğŸ§  æ ¸å¿ƒé€»è¾‘
    // ==========================================
    async function fetchData() {
        log("1. å¼€å§‹è¿æ¥ç»´æ ¼è¡¨ API...", 'info');
        
        // æ£€æŸ¥é…ç½®æ ¼å¼
        if(!VIKA_CONFIG.TOKEN.startsWith("usk")) {
            log("âŒ é”™è¯¯ï¼šToken æ ¼å¼ä¸å¯¹ï¼å¿…é¡»ä»¥ 'usk' å¼€å¤´ã€‚æ‚¨å¡«çš„æ˜¯ï¼š" + VIKA_CONFIG.TOKEN, 'err');
            return;
        }
        if(!VIKA_CONFIG.DATASHEET_ID.startsWith("dst")) {
            log("âŒ é”™è¯¯ï¼šè¡¨æ ¼ ID æ ¼å¼ä¸å¯¹ï¼å¿…é¡»ä»¥ 'dst' å¼€å¤´ã€‚æ‚¨å¡«çš„æ˜¯ï¼š" + VIKA_CONFIG.DATASHEET_ID, 'err');
            return;
        }

        const url = `https://api.vika.cn/fusion/v1/datasheets/${VIKA_CONFIG.DATASHEET_ID}/records?fieldKey=name&t=${new Date().getTime()}`;
        
        try {
            const response = await fetch(url, { headers: { "Authorization": `Bearer ${VIKA_CONFIG.TOKEN}` } });
            
            log(`2. æœåŠ¡å™¨å“åº”çŠ¶æ€: ${response.status}`, 'info');

            if(response.status === 401) {
                log("âŒ è®¤è¯å¤±è´¥ (401)ï¼šToken é”™è¯¯æˆ–è¿‡æœŸã€‚è¯·é‡æ–°å»ç»´æ ¼è¡¨ç”Ÿæˆ Tokenã€‚", 'err');
                return;
            }
            if(response.status === 404) {
                log("âŒ æ‰¾ä¸åˆ°è¡¨æ ¼ (404)ï¼šDatas
